# Generated by Django 4.2.16 on 2025-11-16 17:55

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='Application',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('application_code', models.CharField(help_text='Mã đơn ứng tuyển', max_length=50, unique=True)),
                ('full_name', models.CharField(help_text='Họ và tên', max_length=100)),
                ('email', models.EmailField(help_text='Email', max_length=254)),
                ('phone', models.CharField(help_text='Số điện thoại', max_length=20)),
                ('date_of_birth', models.DateField(blank=True, help_text='Ngày sinh', null=True)),
                ('gender', models.IntegerField(blank=True, choices=[(0, 'Nam'), (1, 'Nữ'), (2, 'Khác')], null=True)),
                ('address', models.CharField(blank=True, help_text='Địa chỉ', max_length=300)),
                ('current_position', models.CharField(blank=True, help_text='Vị trí hiện tại', max_length=100)),
                ('current_company', models.CharField(blank=True, help_text='Công ty hiện tại', max_length=200)),
                ('years_of_experience', models.IntegerField(default=0, help_text='Số năm kinh nghiệm')),
                ('education_level', models.IntegerField(blank=True, choices=[(0, 'Phổ thông'), (1, 'Trung cấp'), (2, 'Cao Đẳng'), (3, 'Đại học'), (4, 'Thạc sĩ'), (5, 'Tiến sĩ'), (6, 'Khác')], null=True)),
                ('school', models.CharField(blank=True, help_text='Trường học', max_length=200)),
                ('major', models.CharField(blank=True, help_text='Chuyên ngành', max_length=100)),
                ('resume', models.FileField(help_text='CV ứng viên', upload_to='resumes/')),
                ('cover_letter', models.TextField(blank=True, help_text='Thư xin việc')),
                ('portfolio_url', models.URLField(blank=True, help_text='Link portfolio')),
                ('linkedin_url', models.URLField(blank=True, help_text='Link LinkedIn')),
                ('expected_salary', models.FloatField(blank=True, help_text='Mức lương mong muốn', null=True)),
                ('available_start_date', models.DateField(blank=True, help_text='Ngày có thể bắt đầu', null=True)),
                ('notice_period_days', models.IntegerField(default=0, help_text='Thời gian báo trước (ngày)')),
                ('status', models.CharField(choices=[('new', 'Mới'), ('screening', 'Sơ tuyển'), ('phone_interview', 'Phỏng vấn điện thoại'), ('interview', 'Phỏng vấn'), ('test', 'Làm bài test'), ('offer', 'Đề nghị'), ('accepted', 'Chấp nhận'), ('rejected', 'Từ chối'), ('withdrawn', 'Rút lui')], default='new', max_length=20)),
                ('source', models.CharField(choices=[('website', 'Website công ty'), ('referral', 'Giới thiệu'), ('linkedin', 'LinkedIn'), ('facebook', 'Facebook'), ('indeed', 'Indeed'), ('vietnamworks', 'VietnamWorks'), ('other', 'Khác')], default='website', max_length=20)),
                ('rating', models.IntegerField(blank=True, help_text='Đánh giá (1-5)', null=True)),
                ('notes', models.TextField(blank=True, help_text='Ghi chú nội bộ')),
                ('interview_date', models.DateTimeField(blank=True, help_text='Ngày giờ phỏng vấn', null=True)),
                ('interview_location', models.CharField(blank=True, help_text='Địa điểm phỏng vấn', max_length=300)),
                ('offer_made_date', models.DateField(blank=True, help_text='Ngày đề nghị', null=True)),
                ('offer_accepted_date', models.DateField(blank=True, help_text='Ngày chấp nhận', null=True)),
                ('rejection_reason', models.TextField(blank=True, help_text='Lý do từ chối')),
                ('converted_to_employee', models.BooleanField(default=False)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Application',
                'verbose_name_plural': 'Applications',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Appraisal',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('status', models.CharField(choices=[('pending_self', 'Chờ nhân viên tự đánh giá'), ('pending_manager', 'Chờ quản lý đánh giá'), ('pending_hr', 'Chờ HR phê duyệt'), ('completed', 'Hoàn thành'), ('cancelled', 'Đã hủy')], default='pending_self', max_length=20)),
                ('self_assessment_date', models.DateTimeField(blank=True, null=True)),
                ('manager_review_date', models.DateTimeField(blank=True, null=True)),
                ('final_review_date', models.DateTimeField(blank=True, null=True)),
                ('self_overall_score', models.DecimalField(blank=True, decimal_places=2, help_text='Tổng điểm tự đánh giá', max_digits=5, null=True)),
                ('self_comments', models.TextField(blank=True, help_text='Nhận xét của nhân viên')),
                ('self_achievements', models.TextField(blank=True, help_text='Thành tích nổi bật')),
                ('self_challenges', models.TextField(blank=True, help_text='Khó khăn gặp phải')),
                ('self_development_plan', models.TextField(blank=True, help_text='Kế hoạch phát triển')),
                ('manager_overall_score', models.DecimalField(blank=True, decimal_places=2, help_text='Tổng điểm đánh giá của quản lý', max_digits=5, null=True)),
                ('manager_comments', models.TextField(blank=True, help_text='Nhận xét của quản lý')),
                ('manager_strengths', models.TextField(blank=True, help_text='Điểm mạnh')),
                ('manager_weaknesses', models.TextField(blank=True, help_text='Điểm cần cải thiện')),
                ('manager_recommendations', models.TextField(blank=True, help_text='Đề xuất (thăng chức, tăng lương, đào tạo...)')),
                ('final_score', models.DecimalField(blank=True, decimal_places=2, help_text='Điểm cuối cùng (sau khi HR review)', max_digits=5, null=True)),
                ('overall_rating', models.CharField(blank=True, choices=[('outstanding', 'Xuất sắc'), ('exceeds', 'Vượt mong đợi'), ('meets', 'Đạt yêu cầu'), ('needs_improvement', 'Cần cải thiện'), ('unsatisfactory', 'Không đạt')], max_length=20, null=True)),
                ('hr_comments', models.TextField(blank=True, help_text='Nhận xét của HR')),
                ('salary_adjustment', models.DecimalField(blank=True, decimal_places=2, help_text='Điều chỉnh lương (nếu có)', max_digits=15, null=True)),
                ('promotion_recommended', models.BooleanField(default=False)),
                ('training_recommended', models.TextField(blank=True, help_text='Khóa đào tạo đề xuất')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AppraisalCriteria',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Tên tiêu chí (VD: Chất lượng công việc)', max_length=200)),
                ('description', models.TextField(help_text='Mô tả chi tiết tiêu chí')),
                ('category', models.CharField(choices=[('performance', 'Hiệu suất công việc'), ('behavior', 'Hành vi & Thái độ'), ('skill', 'Kỹ năng chuyên môn'), ('leadership', 'Năng lực lãnh đạo'), ('development', 'Phát triển bản thân')], max_length=20)),
                ('weight', models.DecimalField(decimal_places=2, default=1.0, help_text='Trọng số (%) - tổng các tiêu chí = 100%', max_digits=5)),
                ('max_score', models.IntegerField(default=5, help_text='Điểm tối đa (thường là 5 hoặc 10)')),
                ('order', models.IntegerField(default=0, help_text='Thứ tự hiển thị')),
            ],
            options={
                'verbose_name': 'Appraisal Criterion',
                'verbose_name_plural': 'Appraisal Criteria',
                'ordering': ['period', 'order', 'name'],
            },
        ),
        migrations.CreateModel(
            name='Contract',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('contract_code', models.CharField(default='TEMP', help_text='Mã hợp đồng', max_length=20, unique=True)),
                ('contract_type', models.CharField(choices=[('probation', 'Thử việc'), ('fixed_term', 'Xác định thời hạn'), ('indefinite', 'Không xác định thời hạn'), ('seasonal', 'Thời vụ'), ('part_time', 'Bán thời gian')], max_length=20)),
                ('start_date', models.DateField(help_text='Ngày bắt đầu hiệu lực')),
                ('end_date', models.DateField(blank=True, help_text='Ngày kết thúc (null nếu không xác định thời hạn)', null=True)),
                ('signed_date', models.DateField(blank=True, help_text='Ngày ký', null=True)),
                ('base_salary', models.DecimalField(decimal_places=2, default=0, help_text='Lương cơ bản', max_digits=15)),
                ('allowances', models.JSONField(blank=True, default=dict, help_text='Phụ cấp dạng JSON')),
                ('work_location', models.CharField(blank=True, max_length=255)),
                ('working_hours', models.CharField(default='8:00-17:00', help_text='Giờ làm việc', max_length=100)),
                ('status', models.CharField(choices=[('draft', 'Nháp'), ('active', 'Đang hiệu lực'), ('expired', 'Hết hạn'), ('terminated', 'Chấm dứt'), ('renewed', 'Đã gia hạn')], default='draft', max_length=20)),
                ('terms', models.TextField(blank=True, help_text='Điều khoản hợp đồng')),
                ('notes', models.TextField(blank=True)),
                ('attachment', models.FileField(blank=True, help_text='File hợp đồng PDF', upload_to='contracts/')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['-start_date'],
            },
        ),
        migrations.CreateModel(
            name='Department',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=50)),
                ('description', models.TextField(blank=True)),
                ('date_establishment', models.DateField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
        ),
        migrations.CreateModel(
            name='Employee',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('employee_code', models.CharField(max_length=20, unique=True)),
                ('name', models.CharField(max_length=50)),
                ('gender', models.IntegerField(choices=[(0, 'Nam'), (1, 'Nữ'), (2, 'Khác')])),
                ('birthday', models.DateField()),
                ('place_of_birth', models.CharField(max_length=300)),
                ('place_of_origin', models.CharField(max_length=300)),
                ('place_of_residence', models.CharField(max_length=300)),
                ('identification', models.CharField(max_length=50, unique=True)),
                ('date_of_issue', models.DateField()),
                ('place_of_issue', models.CharField(max_length=300)),
                ('nationality', models.CharField(max_length=50)),
                ('nation', models.CharField(max_length=50)),
                ('religion', models.CharField(max_length=50)),
                ('email', models.EmailField(max_length=50, unique=True)),
                ('phone', models.CharField(max_length=50, unique=True)),
                ('address', models.CharField(max_length=300)),
                ('avatar', models.ImageField(blank=True, upload_to='avatars/')),
                ('marital_status', models.IntegerField(choices=[(0, 'Độc thân'), (1, 'Đã kết hôn'), (2, 'Đã ly hôn')])),
                ('job_position', models.CharField(max_length=50)),
                ('is_manager', models.BooleanField(default=False)),
                ('salary', models.FloatField()),
                ('contract_start_date', models.DateField()),
                ('contract_duration', models.FloatField(help_text='Đơn vị tháng')),
                ('status', models.IntegerField(choices=[(0, 'Onboarding'), (1, 'Thử việc'), (2, 'Nhân viên chính thức'), (3, 'Đã nghỉ việc'), (4, 'Bị sa thải')])),
                ('education_level', models.IntegerField(choices=[(0, 'Phổ thông'), (1, 'Trung cấp'), (2, 'Cao Đẳng'), (3, 'Đại học'), (4, 'Thạc sĩ'), (5, 'Tiến sĩ'), (6, 'Khác')])),
                ('major', models.CharField(max_length=100)),
                ('school', models.CharField(max_length=100)),
                ('certificate', models.TextField(blank=True)),
                ('created_at', models.DateField(auto_now_add=True)),
                ('department', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.department')),
            ],
            options={
                'permissions': [('view_team_employees', 'Can view team employees'), ('view_employee_salary', 'Can view employee salary information'), ('view_all_employees', 'Can view all employees across departments'), ('manage_employee_contracts', 'Can manage employee contracts')],
            },
        ),
        migrations.CreateModel(
            name='ExpenseCategory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, unique=True)),
                ('code', models.CharField(max_length=20, unique=True)),
                ('description', models.TextField(blank=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'verbose_name': 'Expense Category',
                'verbose_name_plural': 'Expense Categories',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='JobTitle',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100)),
                ('salary_coefficient', models.FloatField()),
                ('description', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
        ),
        migrations.CreateModel(
            name='LeaveType',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=100, unique=True)),
                ('code', models.CharField(max_length=20, unique=True)),
                ('description', models.TextField(blank=True)),
                ('max_days_per_year', models.IntegerField(help_text='Số ngày tối đa trong năm')),
                ('requires_approval', models.BooleanField(default=True, help_text='Có cần duyệt không?')),
                ('is_paid', models.BooleanField(default=True, help_text='Có hưởng lương không?')),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='Payroll',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('month', models.IntegerField()),
                ('year', models.IntegerField()),
                ('base_salary', models.FloatField()),
                ('salary_coefficient', models.FloatField()),
                ('standard_working_days', models.IntegerField()),
                ('hourly_rate', models.FloatField()),
                ('total_working_hours', models.FloatField()),
                ('bonus', models.FloatField(default=0)),
                ('penalty', models.FloatField(default=0)),
                ('total_salary', models.FloatField()),
                ('notes', models.TextField(blank=True)),
                ('status', models.CharField(choices=[('pending', 'Chưa xác nhận'), ('confirmed', 'Đã xác nhận')], default='pending', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.employee')),
            ],
            options={
                'unique_together': {('employee', 'month', 'year')},
            },
        ),
        migrations.CreateModel(
            name='SalaryComponent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('code', models.CharField(help_text='Mã thành phần (VD: PC_VITRI, TH_HIEUSUAT)', max_length=50, unique=True)),
                ('name', models.CharField(help_text='Tên thành phần', max_length=100)),
                ('component_type', models.CharField(choices=[('allowance', 'Phụ cấp'), ('bonus', 'Thưởng'), ('deduction', 'Khấu trừ'), ('overtime', 'Làm thêm giờ')], max_length=20)),
                ('calculation_method', models.CharField(choices=[('fixed', 'Cố định'), ('percentage', 'Phần trăm lương cơ bản'), ('formula', 'Công thức tùy chỉnh'), ('hourly', 'Theo giờ'), ('daily', 'Theo ngày')], max_length=20)),
                ('default_amount', models.FloatField(default=0, help_text='Số tiền mặc định')),
                ('percentage', models.FloatField(default=0, help_text='Phần trăm (0-100)')),
                ('formula', models.TextField(blank=True, help_text='Công thức Python (VD: base_salary * 0.1 + bonus)')),
                ('is_taxable', models.BooleanField(default=True, help_text='Tính thuế TNCN')),
                ('is_mandatory', models.BooleanField(default=False, help_text='Bắt buộc áp dụng cho tất cả')),
                ('is_active', models.BooleanField(default=True)),
                ('description', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'ordering': ['component_type', 'name'],
            },
        ),
        migrations.CreateModel(
            name='SalaryRuleTemplate',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Tên template (VD: Template Giám đốc)', max_length=100)),
                ('description', models.TextField(blank=True)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('department', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.department')),
                ('job_title', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.jobtitle')),
            ],
            options={
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='Reward',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('number', models.IntegerField(unique=True)),
                ('description', models.TextField()),
                ('date', models.DateTimeField()),
                ('amount', models.FloatField()),
                ('cash_payment', models.BooleanField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.employee')),
            ],
        ),
        migrations.CreateModel(
            name='PayrollCalculationLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('base_salary', models.FloatField()),
                ('total_allowances', models.FloatField(default=0)),
                ('total_bonuses', models.FloatField(default=0)),
                ('total_deductions', models.FloatField(default=0)),
                ('total_overtime', models.FloatField(default=0)),
                ('taxable_income', models.FloatField(default=0)),
                ('personal_income_tax', models.FloatField(default=0)),
                ('social_insurance', models.FloatField(default=0)),
                ('health_insurance', models.FloatField(default=0)),
                ('unemployment_insurance', models.FloatField(default=0)),
                ('gross_salary', models.FloatField(help_text='Tổng lương trước thuế và bảo hiểm')),
                ('net_salary', models.FloatField(help_text='Lương thực nhận')),
                ('calculation_details', models.JSONField(default=dict, help_text='Chi tiết từng component')),
                ('calculated_at', models.DateTimeField(auto_now_add=True)),
                ('calculated_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.employee')),
                ('payroll', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='calculation_logs', to='app.payroll')),
            ],
            options={
                'ordering': ['-calculated_at'],
            },
        ),
        migrations.CreateModel(
            name='LeaveRequest',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('start_date', models.DateField()),
                ('end_date', models.DateField()),
                ('total_days', models.FloatField(help_text='Số ngày nghỉ (có thể là 0.5 cho nửa ngày)')),
                ('reason', models.TextField()),
                ('status', models.CharField(choices=[('pending', 'Chờ duyệt'), ('approved', 'Đã duyệt'), ('rejected', 'Từ chối'), ('cancelled', 'Đã hủy')], default='pending', max_length=20)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('rejection_reason', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, help_text='Người duyệt (Manager hoặc HR)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_leaves', to='app.employee')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='leave_requests', to='app.employee')),
                ('leave_type', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='app.leavetype')),
            ],
            options={
                'ordering': ['-created_at'],
                'permissions': [('approve_leave_request', 'Can approve leave requests'), ('view_team_leave_requests', 'Can view team leave requests')],
            },
        ),
        migrations.CreateModel(
            name='JobPosting',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('title', models.CharField(help_text='Tiêu đề công việc', max_length=200)),
                ('code', models.CharField(help_text='Mã tin tuyển dụng', max_length=50, unique=True)),
                ('description', models.TextField(help_text='Mô tả công việc')),
                ('requirements', models.TextField(help_text='Yêu cầu công việc')),
                ('responsibilities', models.TextField(help_text='Trách nhiệm công việc')),
                ('benefits', models.TextField(help_text='Quyền lợi')),
                ('employment_type', models.CharField(choices=[('fulltime', 'Toàn thời gian'), ('parttime', 'Bán thời gian'), ('contract', 'Hợp đồng'), ('internship', 'Thực tập')], default='fulltime', max_length=20)),
                ('experience_level', models.CharField(choices=[('entry', 'Mới tốt nghiệp'), ('junior', 'Junior (1-2 năm)'), ('mid', 'Middle (3-5 năm)'), ('senior', 'Senior (5+ năm)'), ('expert', 'Expert (10+ năm)')], default='junior', max_length=20)),
                ('number_of_positions', models.IntegerField(default=1, help_text='Số lượng cần tuyển')),
                ('location', models.CharField(help_text='Địa điểm làm việc', max_length=300)),
                ('salary_min', models.FloatField(blank=True, help_text='Lương tối thiểu', null=True)),
                ('salary_max', models.FloatField(blank=True, help_text='Lương tối đa', null=True)),
                ('salary_negotiable', models.BooleanField(default=False, help_text='Lương thỏa thuận')),
                ('deadline', models.DateField(help_text='Hạn nộp hồ sơ')),
                ('start_date', models.DateField(blank=True, help_text='Ngày dự kiến nhận việc', null=True)),
                ('status', models.CharField(choices=[('draft', 'Nháp'), ('open', 'Đang mở'), ('closed', 'Đã đóng'), ('cancelled', 'Đã hủy')], default='draft', max_length=20)),
                ('contact_person', models.CharField(blank=True, help_text='Người liên hệ', max_length=100)),
                ('contact_email', models.EmailField(blank=True, help_text='Email liên hệ', max_length=254)),
                ('contact_phone', models.CharField(blank=True, help_text='Điện thoại liên hệ', max_length=20)),
                ('views_count', models.IntegerField(default=0, help_text='Số lượt xem')),
                ('applications_count', models.IntegerField(default=0, help_text='Số lượt ứng tuyển')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_jobs', to='app.employee')),
                ('department', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.department')),
                ('job_title', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.jobtitle')),
            ],
            options={
                'verbose_name': 'Job Posting',
                'verbose_name_plural': 'Job Postings',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='Expense',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('amount', models.DecimalField(decimal_places=2, help_text='Số tiền yêu cầu hoàn', max_digits=12)),
                ('date', models.DateField(help_text='Ngày phát sinh chi phí')),
                ('description', models.TextField(help_text='Mô tả chi tiết chi phí')),
                ('receipt', models.ImageField(blank=True, help_text='Ảnh hóa đơn', null=True, upload_to='receipts/')),
                ('status', models.CharField(choices=[('pending', 'Chờ duyệt'), ('approved', 'Đã duyệt'), ('rejected', 'Từ chối'), ('paid', 'Đã thanh toán'), ('cancelled', 'Đã hủy')], default='pending', max_length=20)),
                ('approved_at', models.DateTimeField(blank=True, null=True)),
                ('rejection_reason', models.TextField(blank=True)),
                ('paid_at', models.DateTimeField(blank=True, null=True)),
                ('payment_method', models.CharField(blank=True, choices=[('cash', 'Tiền mặt'), ('bank_transfer', 'Chuyển khoản'), ('check', 'Séc')], max_length=50)),
                ('payment_reference', models.CharField(blank=True, help_text='Mã giao dịch/Số séc', max_length=100)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('approved_by', models.ForeignKey(blank=True, help_text='Người duyệt (Manager hoặc HR)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='approved_expenses', to='app.employee')),
                ('category', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, to='app.expensecategory')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='expenses', to='app.employee')),
                ('paid_by', models.ForeignKey(blank=True, help_text='Người thanh toán (Kế toán)', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='paid_expenses', to='app.employee')),
            ],
            options={
                'verbose_name': 'Expense',
                'verbose_name_plural': 'Expenses',
                'ordering': ['-created_at'],
                'permissions': [('approve_expense', 'Can approve expense claims'), ('pay_expense', 'Can pay approved expenses')],
            },
        ),
        migrations.CreateModel(
            name='Evaluation',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('period', models.CharField(max_length=50)),
                ('score', models.FloatField()),
                ('comment', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.employee')),
            ],
        ),
        migrations.AddField(
            model_name='employee',
            name='job_title',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.jobtitle'),
        ),
        migrations.CreateModel(
            name='Discipline',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('number', models.IntegerField(unique=True)),
                ('description', models.TextField()),
                ('date', models.DateTimeField()),
                ('amount', models.FloatField()),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.employee')),
            ],
        ),
        migrations.CreateModel(
            name='ContractHistory',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action', models.CharField(choices=[('created', 'Tạo mới'), ('renewed', 'Gia hạn'), ('salary_adjusted', 'Điều chỉnh lương'), ('terminated', 'Chấm dứt'), ('status_changed', 'Thay đổi trạng thái')], max_length=20)),
                ('description', models.TextField(help_text='Mô tả chi tiết thay đổi')),
                ('old_value', models.JSONField(blank=True, help_text='Giá trị cũ (nếu có)', null=True)),
                ('new_value', models.JSONField(blank=True, help_text='Giá trị mới', null=True)),
                ('performed_at', models.DateTimeField(auto_now_add=True)),
                ('contract', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='history', to='app.contract')),
                ('performed_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.employee')),
            ],
            options={
                'verbose_name_plural': 'Contract histories',
                'ordering': ['-performed_at'],
            },
        ),
        migrations.AddField(
            model_name='contract',
            name='created_by',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='contracts_created', to='app.employee'),
        ),
        migrations.AddField(
            model_name='contract',
            name='department',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.department'),
        ),
        migrations.AddField(
            model_name='contract',
            name='employee',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='contracts', to='app.employee'),
        ),
        migrations.AddField(
            model_name='contract',
            name='job_title',
            field=models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.jobtitle'),
        ),
        migrations.AddField(
            model_name='contract',
            name='renewed_from',
            field=models.ForeignKey(blank=True, help_text='Hợp đồng cũ được gia hạn', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='renewals', to='app.contract'),
        ),
        migrations.CreateModel(
            name='Attendance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('date', models.DateTimeField()),
                ('status', models.CharField(choices=[('Có làm việc', 'Có làm việc'), ('Nghỉ phép', 'Nghỉ phép'), ('Nghỉ không phép', 'Nghỉ không phép')], max_length=50)),
                ('working_hours', models.FloatField(default=0)),
                ('notes', models.CharField(blank=True, max_length=300)),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.employee')),
            ],
        ),
        migrations.CreateModel(
            name='AppraisalScore',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('self_score', models.IntegerField(blank=True, help_text='Điểm tự đánh giá', null=True)),
                ('self_comment', models.TextField(blank=True, help_text='Giải thích điểm tự đánh giá')),
                ('manager_score', models.IntegerField(blank=True, help_text='Điểm quản lý đánh giá', null=True)),
                ('manager_comment', models.TextField(blank=True, help_text='Giải thích điểm quản lý')),
                ('final_score', models.IntegerField(blank=True, help_text='Điểm cuối cùng', null=True)),
                ('appraisal', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='scores', to='app.appraisal')),
                ('criteria', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.appraisalcriteria')),
            ],
            options={
                'ordering': ['criteria__order', 'criteria__name'],
            },
        ),
        migrations.CreateModel(
            name='AppraisalPeriod',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(help_text='Tên kỳ đánh giá (VD: Đánh giá năm 2025)', max_length=200)),
                ('description', models.TextField(blank=True, help_text='Mô tả mục đích, phạm vi đánh giá')),
                ('start_date', models.DateField(help_text='Ngày bắt đầu kỳ đánh giá')),
                ('end_date', models.DateField(help_text='Ngày kết thúc kỳ đánh giá')),
                ('self_assessment_deadline', models.DateField(help_text='Deadline nhân viên tự đánh giá')),
                ('manager_review_deadline', models.DateField(help_text='Deadline quản lý hoàn thành đánh giá')),
                ('status', models.CharField(choices=[('draft', 'Nháp'), ('active', 'Đang diễn ra'), ('closed', 'Đã kết thúc'), ('archived', 'Lưu trữ')], default='draft', max_length=20)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('applicable_departments', models.ManyToManyField(blank=True, help_text='Phòng ban áp dụng (để trống = tất cả)', to='app.department')),
                ('applicable_job_titles', models.ManyToManyField(blank=True, help_text='Chức danh áp dụng (để trống = tất cả)', to='app.jobtitle')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_appraisal_periods', to='app.employee')),
            ],
            options={
                'ordering': ['-start_date'],
            },
        ),
        migrations.AddField(
            model_name='appraisalcriteria',
            name='period',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='criteria', to='app.appraisalperiod'),
        ),
        migrations.CreateModel(
            name='AppraisalComment',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('author_type', models.CharField(choices=[('employee', 'Nhân viên'), ('manager', 'Quản lý'), ('hr', 'HR')], max_length=20)),
                ('content', models.TextField(help_text='Nội dung góp ý')),
                ('is_private', models.BooleanField(default=False, help_text='Chỉ HR và quản lý thấy')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('appraisal', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comments', to='app.appraisal')),
                ('author', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.employee')),
            ],
            options={
                'ordering': ['created_at'],
            },
        ),
        migrations.AddField(
            model_name='appraisal',
            name='employee',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='appraisals', to='app.employee'),
        ),
        migrations.AddField(
            model_name='appraisal',
            name='manager',
            field=models.ForeignKey(help_text='Người quản lý trực tiếp đánh giá', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='managed_appraisals', to='app.employee'),
        ),
        migrations.AddField(
            model_name='appraisal',
            name='period',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='appraisals', to='app.appraisalperiod'),
        ),
        migrations.CreateModel(
            name='ApplicationNote',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('note', models.TextField(help_text='Ghi chú')),
                ('is_important', models.BooleanField(default=False, help_text='Đánh dấu quan trọng')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('application', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='application_notes', to='app.application')),
                ('author', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, to='app.employee')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='application',
            name='assigned_to',
            field=models.ForeignKey(blank=True, help_text='Người phụ trách', null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='assigned_applications', to='app.employee'),
        ),
        migrations.AddField(
            model_name='application',
            name='employee',
            field=models.OneToOneField(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='application', to='app.employee'),
        ),
        migrations.AddField(
            model_name='application',
            name='interviewer',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='interviews_conducted', to='app.employee'),
        ),
        migrations.AddField(
            model_name='application',
            name='job',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='applications', to='app.jobposting'),
        ),
        migrations.CreateModel(
            name='SalaryRuleTemplateItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('custom_amount', models.FloatField(blank=True, null=True)),
                ('custom_percentage', models.FloatField(blank=True, null=True)),
                ('custom_formula', models.TextField(blank=True)),
                ('is_active', models.BooleanField(default=True)),
                ('order', models.IntegerField(default=0, help_text='Display order')),
                ('component', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.salarycomponent')),
                ('template', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='template_items', to='app.salaryruletemplate')),
            ],
            options={
                'ordering': ['order', 'component__name'],
                'unique_together': {('template', 'component')},
            },
        ),
        migrations.CreateModel(
            name='PermissionAuditLog',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('username', models.CharField(help_text='Username at time of action', max_length=150)),
                ('user_groups', models.JSONField(default=list, help_text="User's groups at time of action")),
                ('action', models.CharField(choices=[('denied', 'Access Denied'), ('granted', 'Access Granted'), ('attempted', 'Access Attempted')], default='denied', max_length=20)),
                ('resource_type', models.CharField(help_text='Contract, LeaveRequest, Expense, Payroll, etc.', max_length=50)),
                ('resource_id', models.IntegerField(blank=True, help_text='ID of the resource accessed', null=True)),
                ('permission_required', models.CharField(help_text='Permission that was checked', max_length=100)),
                ('timestamp', models.DateTimeField(auto_now_add=True)),
                ('ip_address', models.GenericIPAddressField(blank=True, null=True)),
                ('user_agent', models.TextField(blank=True)),
                ('reason', models.TextField(help_text='Reason for denial or additional context')),
                ('view_name', models.CharField(blank=True, help_text='Django view name', max_length=100)),
                ('url_path', models.CharField(blank=True, max_length=500)),
                ('extra_data', models.JSONField(blank=True, default=dict, help_text='Additional context (department, etc.)')),
                ('user', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='audit_logs', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Permission Audit Log',
                'verbose_name_plural': 'Permission Audit Logs',
                'ordering': ['-timestamp'],
                'indexes': [models.Index(fields=['-timestamp'], name='app_permiss_timesta_739c46_idx'), models.Index(fields=['user', '-timestamp'], name='app_permiss_user_id_6bc35d_idx'), models.Index(fields=['action', '-timestamp'], name='app_permiss_action_a03ba4_idx'), models.Index(fields=['resource_type', 'resource_id'], name='app_permiss_resourc_3f91e7_idx')],
            },
        ),
        migrations.CreateModel(
            name='LeaveBalance',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('year', models.IntegerField()),
                ('total_days', models.FloatField(help_text='Tổng số ngày phép được cấp')),
                ('used_days', models.FloatField(default=0, help_text='Số ngày đã sử dụng')),
                ('remaining_days', models.FloatField(help_text='Số ngày còn lại')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='leave_balances', to='app.employee')),
                ('leave_type', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.leavetype')),
            ],
            options={
                'ordering': ['-year', 'leave_type'],
                'unique_together': {('employee', 'leave_type', 'year')},
            },
        ),
        migrations.CreateModel(
            name='EmployeeSalaryRule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('custom_amount', models.FloatField(blank=True, help_text='Số tiền tùy chỉnh (override default)', null=True)),
                ('custom_percentage', models.FloatField(blank=True, help_text='Phần trăm tùy chỉnh', null=True)),
                ('custom_formula', models.TextField(blank=True, help_text='Công thức tùy chỉnh')),
                ('effective_from', models.DateField(help_text='Có hiệu lực từ ngày')),
                ('effective_to', models.DateField(blank=True, help_text='Hết hiệu lực (null = vô thời hạn)', null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('component', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to='app.salarycomponent')),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='created_salary_rules', to='app.employee')),
                ('employee', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='salary_rules', to='app.employee')),
            ],
            options={
                'ordering': ['-effective_from'],
                'unique_together': {('employee', 'component', 'effective_from')},
            },
        ),
        migrations.AddIndex(
            model_name='contract',
            index=models.Index(fields=['employee', 'status'], name='app_contrac_employe_96c0b0_idx'),
        ),
        migrations.AddIndex(
            model_name='contract',
            index=models.Index(fields=['end_date'], name='app_contrac_end_dat_7559b0_idx'),
        ),
        migrations.AddIndex(
            model_name='contract',
            index=models.Index(fields=['status'], name='app_contrac_status_b794cb_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='appraisalscore',
            unique_together={('appraisal', 'criteria')},
        ),
        migrations.AddIndex(
            model_name='appraisalperiod',
            index=models.Index(fields=['status', '-start_date'], name='app_apprais_status_6170b0_idx'),
        ),
        migrations.AddIndex(
            model_name='appraisal',
            index=models.Index(fields=['period', 'status'], name='app_apprais_period__fbfd9e_idx'),
        ),
        migrations.AddIndex(
            model_name='appraisal',
            index=models.Index(fields=['employee', '-created_at'], name='app_apprais_employe_3e584f_idx'),
        ),
        migrations.AlterUniqueTogether(
            name='appraisal',
            unique_together={('period', 'employee')},
        ),
    ]
