{% extends 'hod_template/base_template.html'%}
{% block page_title %}
Thêm mới nhân viên
{% endblock page_title %}
{% load static %}
{% block main_content %}
<!-- Main content -->
    <section class="content">
      <div class="container-fluid">
        <form role="form" action="{% url 'management_add_employee_save' %}" method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="row">
            <!-- LEFT COLUMN -->
            <div class="col-md-6">
              <!-- Thông tin cá nhân -->
              <div class="card card-primary">
                <div class="card-header">
                  <h3 class="card-title">Thông tin cá nhân</h3>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label>Mã nhân viên</label>
                    <input type="text" class="form-control" name="employee_code" value="{{ employee_code }}" readonly>
                  </div>
                  <div class="form-group">
                    <label>Họ và tên<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="employee_name" placeholder="Nhập Họ và tên" required>
                  </div>
                  <div class="form-group">
                    <label>Giới tính<span class="text-danger">*</span></label>
                    <select class="form-control" name="employee_gender" required>
                      <option value="0">Nam</option>
                      <option value="1">Nữ</option>
                      <option value="2">Khác</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Ngày sinh<span class="text-danger">*</span></label>
                    <input type="date" name="employee_birthday" class="form-control" data-inputmask-alias="datetime" data-inputmask-inputformat="dd/mm/yyyy" data-mask required>
                  </div>
                  <div class="form-group">
                    <label>Nơi sinh</label>
                    <input type="text" class="form-control" name="employee_place_of_birth">
                  </div>
                  <div class="form-group">
                    <label>Nguyên quán<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="employee_place_of_origin" required>
                  </div>
                  <div class="form-group">
                    <label>Nơi thường trú<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="employee_place_of_residence" required>
                  </div>
                  <div class="form-group">
                    <label>Căn cước công dân<span class="text-danger">*</span></label>
                    <input type="number" class="form-control" name="employee_identification" required>
                  </div>
                  <div class="form-group">
                    <label>Ngày cấp<span class="text-danger">*</span></label>
                    <input type="date" class="form-control" name="employee_date_of_issue" data-inputmask-alias="datetime" data-inputmask-inputformat="dd/mm/yyyy" data-mask required>
                  </div>
                  <div class="form-group">
                    <label>Nơi cấp<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="employee_place_of_issue" required>
                  </div>
                  <div class="form-group">
                    <label>Quốc tịch<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="employee_nationality" required>
                  </div>
                  <div class="form-group">
                    <label>Dân tộc<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="employee_nation" required>
                  </div>
                  <div class="form-group">
                    <label>Tôn giáo<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="employee_religion" required>
                  </div>
                  <div class="form-group">
                    <label>Tình trạng hôn nhân<span class="text-danger">*</span></label>
                    <select class="form-control" name="employee_marital_status" required>
                      <option value="0">Độc thân</option>
                      <option value="1">Đã kết hôn</option>
                      <option value="2">Đã ly hôn</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Ảnh đại diện -->
              <div class="card card-secondary">
                <div class="card-header">
                  <h3 class="card-title">Ảnh đại diện</h3>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <div class="custom-file">
                      <input type="file" class="custom-file-input" id="customFile" name="employee_avatar" accept=".jpg,.jpeg,.png" required>
                      <label class="custom-file-label">Tải lên hình ảnh (jpg, jpeg, png)<span class="text-danger">*</span></label>
                    </div>
                  </div>
                  <div class="mt-3">
                    <img id="avatarPreview" src="#" alt="Ảnh xem trước" style="max-width: 200px; display: none; border: 1px solid #ddd; padding: 5px;">
                  </div>
                </div>
              </div>
            </div>

            <!-- RIGHT COLUMN -->
            <div class="col-md-6">
              <!-- Thông tin liên lạc -->
              <div class="card card-warning">
                <div class="card-header">
                  <h3 class="card-title">Thông tin liên lạc</h3>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label>Số điện thoại<span class="text-danger">*</span></label>
                    <input type="tel" class="form-control" name="employee_phone" required>
                  </div>
                  <div class="form-group">
                    <label>Email<span class="text-danger">*</span></label>
                    <input type="email" class="form-control" name="employee_email" required>
                  </div>
                  <div class="form-group">
                    <label>Địa chỉ liên lạc<span class="text-danger">*</span></label>
                    <input type="text" class="form-control" name="employee_address" required>
                  </div>
                </div>
              </div>

              <!-- Thông tin làm việc -->
              <div class="card card-info">
                <div class="card-header">
                  <h3 class="card-title">Thông tin làm việc</h3>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label>Phòng ban<span class="text-danger">*</span></label>
                    <select class="form-control" name="employee_department" required>
                      {% for dept in departments %}
                        <option value="{{ dept.id }}">{{ dept.name }}</option>
                      {% endfor %}
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Vị trí làm việc</label>
                    <input type="text" class="form-control" name="employee_job_position">
                  </div>
                  <div class="form-group">
                    <label>Chức vụ<span class="text-danger">*</span></label>
                    <select class="form-control" name="employee_job_title" required>
                      {% for title in job_titles %}
                        <option value="{{ title.id }}">{{ title.name }}</option>
                      {% endfor %}
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Lương cơ bản<span class="text-danger">*</span></label>
                    <input type="number" class="form-control" name="employee_salary" required>
                  </div>
                  <div class="form-group">
                    <label>Ngày bắt đầu hợp đồng<span class="text-danger">*</span></label>
                    <input type="date" class="form-control" name="employee_contract_start_date" data-inputmask-alias="datetime" data-inputmask-inputformat="dd/mm/yyyy" data-mask required>
                  </div>
                  <div class="form-group">
                    <label>Thời lượng hợp đồng (tháng)<span class="text-danger">*</span></label>
                    <input type="number" class="form-control" name="employee_contract_duration" required>
                  </div>
                  <div class="form-group">
                    <label>Trạng thái<span class="text-danger">*</span></label>
                    <select class="form-control" name="employee_status" required>
                      <option value="0">Onboarding</option>
                      <option value="1">Thử việc</option>
                      <option value="2">Nhân viên chính thức</option>
                      <option value="3">Đã nghỉ việc</option>
                      <option value="4">Bị sa thải</option>
                    </select>
                  </div>
                </div>
              </div>

              <!-- Học vấn -->
              <div class="card card-success">
                <div class="card-header">
                  <h3 class="card-title">Học vấn, Chứng chỉ</h3>
                </div>
                <div class="card-body">
                  <div class="form-group">
                    <label>Trình độ</label>
                    <select class="form-control" name="employee_education_level">
                      <option value="0">Trung cấp</option>
                      <option value="1">Cao đẳng</option>
                      <option value="2">Đại học</option>
                      <option value="3">Thạc sĩ</option>
                      <option value="4">Tiến sĩ</option>
                      <option value="5">Khác</option>
                    </select>
                  </div>
                  <div class="form-group">
                    <label>Ngành/Lĩnh vực</label>
                    <input type="text" class="form-control" name="employee_major">
                  </div>
                  <div class="form-group">
                    <label>Trường</label>
                    <input type="text" class="form-control" name="employee_school">
                  </div>
                  <div class="form-group">
                    <label>Chứng chỉ</label>
                    <input type="text" class="form-control" name="employee_certificate">
                  </div>
                </div>
              </div>
            </div>
          </div>

          {% if messages %}
            {% for message in messages %}
              <div class="alert alert-{{ message.tags }}">{{ message }}</div>
            {% endfor %}
          {% endif %}
          <!-- Submit -->
          <div class="card-footer">
            <button type="submit" class="btn btn-primary btn-block">Lưu</button>
          </div>
        </form>

      </div><!-- /.container-fluid -->
    </section>
    <!-- /.content -->

{% endblock main_content %}

{% block custom_js %}
<script>
  document.getElementById("customFile").addEventListener("change", function(event) {
    const [file] = event.target.files;
    if (file) {
      const preview = document.getElementById("avatarPreview");
      preview.src = URL.createObjectURL(file);
      preview.style.display = "block";
    }
  });
</script>
{% endblock custom_js %}